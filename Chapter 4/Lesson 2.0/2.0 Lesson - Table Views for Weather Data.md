# 2.0 Lesson - Table Views for Weather Data #

Paul Solt - [Paul@SuperEasyApps.com](mailto:Paul@SuperEasyApps.com)
[SuperEasyApps.com](http://SuperEasyApps.com)

-----

* 2.0 Lesson - Table Views for Weather Data

## 2.1 Lecture - Table Views for Weather Data ##

In this lesson you will learn how to start using Table Views with the existing weather JSON data. Throughout the lesson you will learn more about data structure and how to display new information to the user.

## 2.2 Tutorial - Weather Forecast API Data ##

You need to refactor the app to support additional weather information. Your initial app worked well with a small amount of data, but now you need to parse more information. 

1. Create a new iOS Swift file called `WeatherDataBlock.swift`

	```swift
	import Foundation
	struct WeatherDataBlock {
		var summary: String?
		var icon: String?
		var dataPoints: [WeatherDataPoint]?
	}
	```
	
2. Create a new iOS Swift file called `WeatherForecast.swift`

	```swift
	import Foundation
	struct WeatherForecast {
		var currently: WeatherDataPoint?
		var daily: WeatherDataBlock?
		var hourly: WeatherDataBlock?
	}
	```
	
3. Add three new properties (date, maxTemperature, minTemperature) to the `WeatherDataPoint.swift`

	```swift
	import Foundation
	struct WeatherDataPoint {
		var temperature: Float?
		var summary: String?
		var icon: String?
		
		var date: NSDate?
		var maxTemperature: Float?
		var minTemperature: Float?
	}
	```

4. Create a group in Xcode to organize the new weather code files

## 2.3 Tutorial - Update WeatherDataPoint JSON Parsing ##

1. Add the code to parse a `WeatherDataPoint.swift` structure using the JSON data file.

	```swift
	struct WeatherDataPoint {
		var temperature: Float?
		var summary: String?
		var icon: String?
		
		var date: NSDate?
		var maxTemperature: Float?
		var minTemperature: Float?
		
		init(jsonData: [String : AnyObject]) {
			
			if let temperature = jsonData["temperature"] as? Float {
				print("temperature:", temperature)
				self.temperature = temperature
			}
			if let summary = jsonData["summary"] as? String {
				print("summary:", summary)
				self.summary = summary
			}
			if let icon = jsonData["icon"] as? String {
				print("icon:", icon)
				self.icon = icon
			}
			
			// Add low/high temperatures
			
			if let minTemperature = jsonData["temperatureMin"] as? Float {
				print("min temp:", minTemperature)
				self.minTemperature = minTemperature
			}
			
			if let maxTemperature = jsonData["temperatureMax"] as? Float {
				print("max temp:", maxTemperature)
				self.maxTemperature = maxTemperature
			}
			
			if let time = jsonData["time"] as? Double {
				
				self.date = NSDate(timeIntervalSince1970: time)
				
				print("date:", self.date!)
				print(dayFromDate(self.date!))
			}
		}
	}
	```

2. Create a new parseWeather(weatherJSON:) method in ViewController.swift to test the parsing

	```swift
	func parseWeather(weatherJSON: [String : AnyObject]) {
		if let currentWeather = weatherJSON["currently"] as? [String : AnyObject] {
			let dataPoint = WeatherDataPoint(jsonData: currentWeather)
			print(dataPoint)
		}
	}
	```

## 2.4 Parse the Weather Data Block ##

1. Add the init method to parse a data block to get access to the daily data.

	```swift
	struct WeatherDataPoint {
		var temperature: Float?
		var summary: String?
		var icon: String?
		
		var date: NSDate?
		var maxTemperature: Float?
		var minTemperature: Float?
		
		init(jsonData: [String : AnyObject]) {
			
			if let temperature = jsonData["temperature"] as? Float {
				print("temperature:", temperature)
				self.temperature = temperature
			}
			if let summary = jsonData["summary"] as? String {
				print("summary:", summary)
				self.summary = summary
			}
			if let icon = jsonData["icon"] as? String {
				print("icon:", icon)
				self.icon = icon
			}
			
			// Add low/high temperatures
			
			if let minTemperature = jsonData["temperatureMin"] as? Float {
				print("min temp:", minTemperature)
				self.minTemperature = minTemperature
			}
			
			if let maxTemperature = jsonData["temperatureMax"] as? Float {
				print("max temp:", maxTemperature)
				self.maxTemperature = maxTemperature
			}
			
			if let time = jsonData["time"] as? Double {
				
				self.date = NSDate(timeIntervalSince1970: time)
				
				print("date:", self.date!)
				print(dayFromDate(self.date!))
			}
		}
	}
	```

2. Test the parsing logic of data blocks in ViewController.swift

```swift

```


## 2.5 Parse the Weather Forecast Data ##

1. Parse the weather forecast in WeatherForecast.swift

	```swift
	struct WeatherForecast {
		var currently: WeatherDataPoint?
		var daily: WeatherDataBlock?
		var hourly: WeatherDataBlock?
		
		init(jsonData: [String : AnyObject]) {
			if let currentWeather = jsonData["currently"] as? [String : AnyObject] {
				print("currently:", currentWeather)
				self.currently = WeatherDataPoint(jsonData: currentWeather)
			}
			if let dailyWeather = jsonData["daily"] as? [String : AnyObject] {
				print("daily parsing")
				self.daily = WeatherDataBlock(jsonData: dailyWeather)
			}
		}
	}
	
	```

2. Test the weather forecast parsing in ViewController.swift

3. Store the weather forecast as a local property
